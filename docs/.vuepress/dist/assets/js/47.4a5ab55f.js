(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{1299:function(e,t,n){"use strict";n.r(t),n.d(t,"previewCIMSymbol",(function(){return M}));var r,i,o=n(348),a=n(370),c=n(353),s=n(345),l=n(434),f=n(351),u=n(429),h=n(946),m=n(949),d=n(1092),y=n(416),g=n(937),p=n(1053);(i=r||(r={})).Legend="legend",i.Preview="preview";const b=(e,t,n)=>{if(e&&e.targetSize){let r;if(n){const t=Math.max(n.frame.xmax-n.frame.xmin,n.frame.ymax-n.frame.ymin);r=e.targetSize/Object(o.c)(t)}else r=e.targetSize/t.referenceSize;return r}return e&&e.scaleFactor?e.scaleFactor:1},O={fill:{legend:{frame:{xmax:15,xmin:0,ymax:15,ymin:0},geometry:{rings:[[[0,15],[15,7.5],[15,0],[0,0],[0,15]]]},canvasPaths:{rings:[[[0,15],[0,0],[15,7.5],[15,15],[0,15]]]}},preview:{frame:{xmax:100,xmin:0,ymax:100,ymin:0},geometry:{rings:[[[0,100],[100,100],[100,0],[0,0],[0,100]]]},canvasPaths:{rings:[[[0,100],[0,0],[100,0],[100,100],[0,100]]]}}},stroke:{legend:{frame:{xmax:24,xmin:0,ymax:2,ymin:-2},geometry:{paths:[[[0,0],[12,0],[24,0]]]},canvasPaths:{paths:[[[0,2],[12,2],[24,2]]]}},preview:{frame:{xmax:100,xmin:0,ymax:2,ymin:-2},geometry:{paths:[[[0,0],[50,0],[100,0]]]},canvasPaths:{paths:[[[0,2],[50,2],[100,2]]]}}}};function x(e,t,n,r){let i,o;return"function"==typeof e.materialHash?(i=(0,e.materialHash)(t,n,r),o=Object(u.a)(e.cim,e.materialOverrides)):(i=e.materialHash,o=e.cim),{analyzedCIM:o,hash:i}}var j=n(783);const w=new class{constructor(e,t){this._spatialReference=e,this._avoidSDF=t,this._resourceCache=new Map,this._pictureMarkerCache=new Map,this._textRasterizer=new d.a,this._cimResourceManager=new h.a,this._rasterizer=new m.a(this._cimResourceManager)}async rasterizeCIMSymbolAsync(e,t,n,r,i,o,a,c){r=r||(t?null!=t.centroid?"esriGeometryPolygon":Object(f.c)(t.geometry):null)||function(e){if(!(e&&e.data&&e.data.symbol))return null;switch(e.data.symbol.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}(e);const s=await this.analyzeCIMSymbol(e,t?function(e){return(e?Object.keys(e):[]).map(t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"}))}(t.attributes):null,n,r,c);return this.rasterizeCIMSymbol(s,t,r,i,o,a)}async analyzeCIMSymbol(e,t,n,r,i){const o=[],a=t?{geometryType:r,spatialReference:this._spatialReference,fields:t}:null;let c;await Object(u.b)(e.data,a,this._cimResourceManager,o,this._avoidSDF),Object(s.u)(i);for(const e of o)"CIMPictureMarker"!==e.cim.type&&"CIMPictureFill"!==e.cim.type&&"CIMPictureStroke"!==e.cim.type||(c||(c=[]),c.push(this.fetchPictureMarkerResource(e,i))),n&&"text"===e.type&&"string"==typeof e.text&&e.text.indexOf("[")>-1&&(e.text=Object(y.c)(n,e.text,e.cim.textCase));return c&&await Promise.all(c),o}async fetchPictureMarkerResource(e,t){const n=e.materialHash;if(!this._pictureMarkerCache.get(n)){const r=(await Object(c.default)(e.cim.url,{responseType:"image",signal:t&&t.signal})).data;this._pictureMarkerCache.set(n,r)}}rasterizeCIMSymbol(e,t,n,r,i,o){const a=[];for(const c of e){r&&"function"==typeof r.scaleFactor&&(r.scaleFactor=r.scaleFactor(t,i,o));const e=this._getRasterizedResource(c,t,n,r,i,o);if(!e)continue;let s=0,l=e.anchorX||0,f=e.anchorY||0,u=!1,h=0,m=0;if("esriGeometryPoint"===n){const e=b(r,c,null);if(h=Object(y.d)(c.offsetX,t,i,o)*e||0,m=Object(y.d)(c.offsetY,t,i,o)*e||0,"marker"===c.type)s=Object(y.d)(c.rotation,t,i,o)||0,u=!!c.rotateClockwise&&c.rotateClockwise;else if("text"===c.type){if(s=Object(y.d)(c.angle,t,i,o)||0,void 0!==c.horizontalAlignment)switch(c.horizontalAlignment){case"left":l=-.5;break;case"right":l=.5;break;default:l=0}if(void 0!==c.verticalAlignment)switch(c.verticalAlignment){case"top":f=.5;break;case"bottom":f=-.5;break;case"baseline":f=-.25;break;default:f=0}}}null!=e&&a.push({angle:s,rotateClockWise:u,anchorX:l,anchorY:f,offsetX:h,offsetY:m,rasterizedResource:e})}return this.getSymbolImage(a)}getSymbolImage(e){const t=document.createElement("canvas"),n=t.getContext("2d");let r=0,i=0,a=0,c=0;const s=[];for(let t=0;t<e.length;t++){const l=e[t],f=l.rasterizedResource;if(!f)continue;const u=f.size,h=l.offsetX,m=l.offsetY,d=l.anchorX,y=l.anchorY,g=l.rotateClockWise||!1;let p=l.angle,b=Object(o.c)(h)-u[0]*(.5+d),O=Object(o.c)(m)-u[1]*(.5+y),x=b+u[0],j=O+u[1];if(p){g&&(p=-p);const e=Math.sin(p*Math.PI/180),t=Math.cos(p*Math.PI/180),n=b*t-O*e,r=b*e+O*t,i=b*t-j*e,o=b*e+j*t,a=x*t-j*e,c=x*e+j*t,s=x*t-O*e,l=x*e+O*t;b=Math.min(n,i,a,s),O=Math.min(r,o,c,l),x=Math.max(n,i,a,s),j=Math.max(r,o,c,l)}r=b<r?b:r,i=O<i?O:i,a=x>a?x:a,c=j>c?j:c;const w=n.createImageData(f.size[0],f.size[1]);w.data.set(new Uint8ClampedArray(f.image.buffer));const M={offsetX:h,offsetY:m,rotateClockwise:g,angle:p,rasterizedImage:w,anchorX:d,anchorY:y};s.push(M)}t.width=a-r,t.height=c-i;const l=-r,f=c;for(let e=0;e<s.length;e++){const t=s[e],r=this._imageDataToCanvas(t.rasterizedImage),i=t.rasterizedImage.width,a=t.rasterizedImage.height,c=l-i*(.5+t.anchorX),u=f-a*(.5-t.anchorY);if(t.angle){const e=(360-t.angle)*Math.PI/180;n.save(),n.translate(Object(o.c)(t.offsetX),-Object(o.c)(t.offsetY)),n.translate(l,f),n.rotate(e),n.translate(-l,-f),n.drawImage(r,c,u),n.restore()}else n.drawImage(r,c+Object(o.c)(t.offsetX),u-Object(o.c)(t.offsetY))}const u=new p.b({x:l/t.width-.5,y:f/t.height-.5});return{imageData:0!==t.width&&0!==t.height?n.getImageData(0,0,t.width,t.height):n.createImageData(1,1),anchorPosition:u}}_imageDataToCanvas(e){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const t=this._imageDataCanvas,n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.putImageData(e,0,0),t}_imageTo32Array(e,t,n,r){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const i=this._imageDataCanvas,o=i.getContext("2d");if(i.width=t,i.height=n,o.drawImage(e,0,0,t,n),r){o.save();const i=new a.a(r);o.fillStyle=i.toHex(),o.globalCompositeOperation="multiply",o.fillRect(0,0,t,n),o.globalCompositeOperation="destination-atop",o.drawImage(e,0,0,t,n),o.restore()}return new Uint32Array(o.getImageData(0,0,t,n).data.buffer)}_getRasterizedResource(e,t,n,i,o,a){let c,s,f,u,h=null,m=null;if("esriGeometryPolyline"===n||"esriGeometryPolygon"===n){const u=i&&i.style?i.style:r.Legend,d="esriGeometryPolyline"===n?O.stroke[u]:O.fill[u];if("line"===e.type){if("CIMSolidStroke"!==e.cim.type){if("CIMPictureStroke"===e.cim.type){const n=Object(y.d)(e.width,t,o,a),r=Object(y.d)(e.color,t,o,a),{image:i,width:c,height:s}=this._getPictureResource(e,n,r);return this._rasterizePictureResource(e,i,c,s,d,n)}return null}({analyzedCIM:c,hash:f}=x(e,t,o,a)),s=this._embedCIMLayerInVectorMarker(c,d)}else if("marker"===e.type){if("CIMPictureMarker"===e.cim.type)return null;if("CIMVectorMarker"!==e.cim.type)return null;e.cim.offsetX=Object(y.d)(e.offsetX,t,o,a),e.cim.offsetY=Object(y.d)(e.offsetY,t,o,a),e.cim.rotation=Object(y.d)(e.rotation,t,o,a),e.cim.markerPlacement=e.markerPlacement,({analyzedCIM:c}=x(e,t,o,a)),f=Object(l.b)(JSON.stringify(c)).toString(),s=this._embedCIMLayerInVectorMarker(c,d),h=Object(y.d)(e.size,t,o,a),m=e.path}else{if("text"===e.type)return null;if("fill"===e.type){if("CIMHatchFill"===e.cim.type||"CIMVectorMarker"===e.cim.type||"CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type){const n=e.cim.size||e.cim.height;let r,i,s;if("CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type)({image:r,width:i,height:s}=this._getPictureResource(e,n,Object(y.d)(e.color,t,o,a)));else{({analyzedCIM:c,hash:f}=x(e,t,o,a));const l=this._rasterizer.rasterizeJSONResource({cim:c,type:e.type,url:e.url,mosaicHash:f,size:n,path:m},1,this._avoidSDF);r=l.image,i=l.size[0],s=l.size[1]}return this._rasterizePictureResource(e,r,i,s,d,null)}if("CIMSolidFill"!==e.cim.type)return null;({analyzedCIM:c,hash:f}=x(e,t,o,a)),s=this._embedCIMLayerInVectorMarker(c,d)}}}else{if("text"===e.type)return u=this._rasterizeTextResource(e,t,i,o,a),u;({analyzedCIM:c,hash:f}=x(e,t,o,a));const n=b(i,e,null);if("CIMPictureMarker"===e.cim.type){const r=Object(y.d)(e.size,t,o,a)*n,{image:i,width:c,height:s}=this._getPictureResource(e,r,Object(y.d)(e.color,t,o,a));return u={image:i,size:[c,s],sdf:!1,simplePattern:!1,anchorX:e.anchorPoint?e.anchorPoint.x:0,anchorY:e.anchorPoint?e.anchorPoint.y:0},u}Object(g.c)(c,n,{preserveOutlineWidth:!1}),s=c}f+=n,i&&(f+=JSON.stringify(i));const d=this._resourceCache;return d.has(f)?d.get(f):(u=this._rasterizer.rasterizeJSONResource({cim:s,type:e.type,url:e.url,mosaicHash:f,size:h,path:m},window.devicePixelRatio||1,this._avoidSDF),d.set(f,u),u)}_rasterizeTextResource(e,t,n,r,i){const o=b(n,e,null),a=Object(y.d)(e.text,t,r,i);if(!a||0===a.length)return null;const c=Object(y.d)(e.fontName,t,r,i),s=Object(y.d)(e.style,t,r,i),l=Object(y.d)(e.weight,t,r,i),f=Object(y.d)(e.decoration,t,r,i),u=Object(y.d)(e.size,t,r,i)*o,h=Object(y.d)(e.horizontalAlignment,t,r,i),m=Object(y.d)(e.verticalAlignment,t,r,i),d=Object(y.b)(Object(y.d)(e.color,t,r,i)),g=Object(y.b)(Object(y.d)(e.outlineColor,t,r,i)),p={color:d,size:u,horizontalAlignment:h,verticalAlignment:m,font:{family:c,style:s,weight:l,decoration:f},halo:{size:Object(y.d)(e.outlineSize,t,r,i)||0,color:g,style:s},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(a,p)}_rasterizePictureResource(e,t,n,r,i,a){const c=document.createElement("canvas"),s=c.getContext("2d");c.height=Object(o.c)(Math.max(i.frame.ymax-i.frame.ymin,a)),c.width=Object(o.c)(i.frame.xmax-i.frame.xmin);const l=s.createImageData(n,r);l.data.set(new Uint8ClampedArray(t.buffer));const u=this._imageDataToCanvas(l),h=s.createPattern(u,"repeat"),m=Math.cos((-e.cim.rotation||0)*Math.PI/180),d=Math.sin((-e.cim.rotation||0)*Math.PI/180);h.setTransform({m11:m,m12:d,m21:-d,m22:m,m41:Object(o.c)(e.cim.offsetX)||0,m42:Object(o.c)(e.cim.offsetY)||0});const y=i.canvasPaths;let g,p,b;Object(f.g)(y)?(g=y.rings,s.fillStyle=h,p=s.fill,b=["evenodd"]):Object(f.h)(y)&&(g=y.paths,s.strokeStyle=h,s.lineWidth=a,p=s.stroke,g[0][0][1]=c.height/2,g[0][1][1]=c.height/2),s.beginPath();for(const e of g){const t=e?e.length:0;if(t>1){let n=e[0];s.moveTo(Object(o.c)(n[0]),Object(o.c)(n[1]));for(let r=1;r<t;++r)n=e[r],s.lineTo(Object(o.c)(n[0]),Object(o.c)(n[1]));s.closePath()}}p.apply(s,b);const O=s.getImageData(0,0,c.width,c.height),x=new Uint8Array(O.data);return{size:[c.width,c.height],image:new Uint32Array(x.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}_getPictureResource(e,t,n){const r=this._pictureMarkerCache.get(e.materialHash);if(!r)return null;const i=r.height/r.width,a=t?i>1?Object(o.c)(t):Object(o.c)(t)/i:r.width,c=t?i>1?Object(o.c)(t)*i:Object(o.c)(t):r.height;return{image:this._imageTo32Array(r,a,c,n),width:a,height:c}}_embedCIMLayerInVectorMarker(e,t){const n=Object(f.g)(t.geometry)?"CIMPolygonSymbol":"CIMLineSymbol",r=t.frame;return{type:"CIMVectorMarker",frame:r,size:r.ymax-r.ymin,markerGraphics:[{type:"CIMMarkerGraphic",geometry:t.geometry,symbol:{type:n,symbolLayers:[e]}}]}}}(null,!0);async function M(e,t={}){const{size:n,maxSize:r,node:i,opacity:a}=t,c=t.cimOptions||t,{feature:s,fieldMap:l,geometryType:f,style:u}=c,h=Object(g.b)(e),m=Math.min(null!=n?n:h,null!=r?r:Object(o.d)(120));m!==h&&(e=e.clone(),Object(g.d)(e,m,{preserveOutlineWidth:!0}));let d=3;e&&e.data&&e.data.symbol&&"CIMPointSymbol"!==e.data.symbol.type&&(d=1);const y=await w.rasterizeCIMSymbolAsync(e,s,l,f,{scaleFactor:d,style:u}),p=document.createElement("canvas");p.width=y.imageData.width,p.height=y.imageData.height,p.getContext("2d").putImageData(y.imageData,0,0);let b=p.width/d,O=p.height/d;if(null!=n&&(null==(null==t?void 0:t.scale)||(null==t?void 0:t.scale))){const e=b/O;b=e<=1?Math.ceil(m*e):m,O=e<=1?m:Math.ceil(m/e)}const x=new Image(b,O);x.src=p.toDataURL(),null!=a&&(x.style.opacity=""+a);let M=x;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:b,height:O,src:x.src},fill:null,stroke:null,offset:[0,0]};M=Object(j.a)([[e]],[b,O],{effectView:t.effectView})}return i&&i.appendChild(M),M}},346:function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return M})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return F})),n.d(t,"e",(function(){return G})),n.d(t,"f",(function(){return D})),n.d(t,"g",(function(){return Y})),n.d(t,"h",(function(){return H})),n.d(t,"i",(function(){return J})),n.d(t,"j",(function(){return T})),n.d(t,"k",(function(){return R})),n.d(t,"l",(function(){return a})),n.d(t,"m",(function(){return C})),n.d(t,"n",(function(){return S})),n.d(t,"o",(function(){return s})),n.d(t,"p",(function(){return k})),n.d(t,"q",(function(){return P})),n.d(t,"r",(function(){return c})),n.d(t,"s",(function(){return v})),n.d(t,"t",(function(){return _})),n.d(t,"u",(function(){return r})),n.d(t,"v",(function(){return X})),n.d(t,"w",(function(){return i})),n.d(t,"x",(function(){return A})),n.d(t,"y",(function(){return d})),n.d(t,"z",(function(){return y})),n.d(t,"A",(function(){return g})),n.d(t,"B",(function(){return p})),n.d(t,"C",(function(){return m})),n.d(t,"D",(function(){return h})),n.d(t,"E",(function(){return b})),n.d(t,"F",(function(){return O})),n.d(t,"G",(function(){return x})),n.d(t,"H",(function(){return j})),n.d(t,"I",(function(){return u})),n.d(t,"J",(function(){return l})),n.d(t,"K",(function(){return I})),n.d(t,"L",(function(){return o})),n.d(t,"M",(function(){return L})),n.d(t,"N",(function(){return N})),n.d(t,"O",(function(){return z}));const r=1e-30,i=4294967295,o=512,a=8,c=29,s=24,l=8,f={metrics:{width:15,height:17,left:0,top:-7,advance:14}},u=0,h=0,m=0,d=1,y=2,g=3,p=4,b=5,O=6,x=5,j=6,w=1,M=2,v=2,k=1,S=2,C=4,I=1.05,P=6,z=5,N=6,L=1.15,A=2,R=8,X=500,_=10,F=2,Y=0,D=1,H=4,J=8,G=4,T=1},357:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));const r=new Float32Array(1);new Uint32Array(r.buffer);function i(e){return[255&e,(65280&e)>>>8,(16711680&e)>>>16,(4278190080&e)>>>24]}function o(e,t){return 65535&e|t<<16}function a(e,t,n,r){return 255&e|(255&t)<<8|(255&n)<<16|r<<24}},420:function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return w})),n.d(t,"f",(function(){return M})),n.d(t,"g",(function(){return v}));var r=n(339),i=n(351);const o=(e,t,n)=>[t,n],a=(e,t,n)=>[t,n,e[2]],c=(e,t,n)=>[t,n,e[2],e[3]];function s(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:Object(r.k)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function l({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function f({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function u(e,t,n){const r=[];let i,o,a,c;for(let s=0;s<n.length;s++){const u=n[s];s>0?(a=l(e,u[0]),c=f(e,u[1]),a===i&&c===o||(r.push(t(u,a-i,c-o)),i=a,o=c)):(i=l(e,u[0]),o=f(e,u[1]),r.push(t(u,i,o)))}return r.length>0?r:null}function h({scale:e,translate:t},n){return n*e[0]+t[0]}function m({scale:e,translate:t},n){return t[1]-n*e[1]}function d(e,t,n){const r=new Array(n.length);if(!n.length)return r;const[i,o]=e.scale;let a=h(e,n[0][0]),c=m(e,n[0][1]);r[0]=t(n[0],a,c);for(let e=1;e<n.length;e++){const s=n[e];a+=s[0]*i,c-=s[1]*o,r[e]=t(s,a,c)}return r}function y(e,t,n){const r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=d(e,t,n[i]);return r}function g(e,t,n,r,i){return t.points=function(e,t,n,r){return u(e,n?r?c:a:r?a:o,t)}(e,n.points,r,i),t}function p(e,t,n,r,i){return t.x=l(e,n.x),t.y=f(e,n.y),t!==n&&(r&&(t.z=n.z),i&&(t.m=n.m)),t}function b(e,t,n,r,i){const s=function(e,t,n,r){const i=[],s=n?r?c:a:r?a:o;for(let n=0;n<t.length;n++){const r=u(e,s,t[n]);r&&r.length>=3&&i.push(r)}return i.length?i:null}(e,n.rings,r,i);return s?(t.rings=s,t):null}function O(e,t,n,r,i){const s=function(e,t,n,r){const i=[],s=n?r?c:a:r?a:o;for(let n=0;n<t.length;n++){const r=u(e,s,t[n]);r&&r.length>=2&&i.push(r)}return i.length?i:null}(e,n.paths,r,i);return s?(t.paths=s,t):null}function x(e,t){return e&&t?Object(i.f)(t)?p(e,{},t,!1,!1):Object(i.h)(t)?O(e,{},t,!1,!1):Object(i.g)(t)?b(e,{},t,!1,!1):Object(i.e)(t)?g(e,{},t,!1,!1):Object(i.d)(t)?function(e,t,n,r,i){return t.xmin=l(e,n.xmin),t.ymin=f(e,n.ymin),t.xmax=l(e,n.xmax),t.ymax=f(e,n.ymax),t!==n&&(r&&(t.zmin=n.zmin,t.zmax=n.zmax),i&&(t.mmin=n.mmin,t.mmax=n.mmax)),t}(e,{},t,!1,!1):null:null}function j(e,t,n,i,s){return Object(r.k)(n)&&(t.points=function(e,t,n,r){return d(e,n?r?c:a:r?a:o,t)}(e,n.points,i,s)),t}function w(e,t,n,i,o){return Object(r.j)(n)||(t.x=h(e,n.x),t.y=m(e,n.y),t!==n&&(i&&(t.z=n.z),o&&(t.m=n.m))),t}function M(e,t,n,i,s){return Object(r.k)(n)&&(t.rings=function(e,t,n,r){return y(e,n?r?c:a:r?a:o,t)}(e,n.rings,i,s)),t}function v(e,t,n,i,s){return Object(r.k)(n)&&(t.paths=function(e,t,n,r){return y(e,n?r?c:a:r?a:o,t)}(e,n.paths,i,s)),t}},428:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(351),i=n(418),o=n(577),a=n(489);class c{static executeEffects(e,t){const n=Object(i.c)(t);let r=new o.a(n);for(const t of e){const e=Object(a.a)(t);e&&(r=e.execute(r,t,96/72,!0))}return r}static next(e){const t=e.next();return Object(i.d)(t),t}static applyEffects(e,t){if(!e)return t;let n=new o.a(t);for(const t of e){const e=Object(a.a)(t);e&&(n=e.execute(n,t,1,!1))}let i,c=null;for(;i=n.next();)c?Object(r.h)(c)?Object(r.h)(i)&&c.paths.push(...i.paths):Object(r.g)(c)&&Object(r.g)(i)&&c.rings.push(...i.rings):c=i;return c}}},429:function(e,t,n){"use strict";n.d(t,"a",(function(){return D})),n.d(t,"b",(function(){return j}));var r=n(370),i=n(343),o=n(339),a=n(348),c=n(434),s=n(414),l=n(404),f=n(478),u=n(416),h=n(428),m=n(430);const d=i.a.getLogger("esri.symbols.cim.cimAnalyzer");function y(e){switch(e){case"Butt":return 0;case"Square":return 2;default:return 1}}function g(e){switch(e){case"Bevel":return 0;case"Miter":return 2;default:return 1}}function p(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function b(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function O(e,t,n,r){let i;e[t]?i=e[t]:(i={},e[t]=i),i[n]=r}function x(e){const t=e.markerPlacement;return t&&t.angleToLine?1:0}async function j(e,t,n,r,i){const o=null!=r?r:[];if(!e)return o;let a,c;const f={};if("CIMSymbolReference"!==e.type)return d.error("Expect cim type to be 'CIMSymbolReference'"),o;if(a=e.symbol,c=e.primitiveOverrides,c){const e=[];for(const n of c){const r=n.valueExpressionInfo;if(r&&t){const i=r.expression,o=Object(s.d)(i,t.spatialReference,t.fields).then(e=>{e&&O(f,n.primitiveName,n.propertyName,e)});e.push(o)}else null!=n.value&&O(f,n.primitiveName,n.propertyName,n.value)}e.length>0&&await Promise.all(e)}const u=[];switch(function e(t,n,r){if(t&&n)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const i=t.symbolLayers;if(!i)return;for(const t of i)switch(t.type){case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMCharacterMarker":case"CIMPictureMarker":"url"in t&&t.url&&r.push(n.fetchResource(t.url,null));break;case"CIMVectorMarker":{const i=t.markerGraphics;if(!i)continue;for(const t of i)if(t){const i=t.symbol;i&&e(i,n,r)}}}}}}(a,n,u),u.length>0&&await Promise.all(u),a.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":!function(e,t,n,r,i,o,a){if(!e)return;const c=e.symbolLayers;if(!c)return;const s=e.effects;let f;const u=l.b.getSize(e);"CIMPointSymbol"===e.type&&"Map"===e.angleAlignment&&(f=1);let h=c.length;for(;h--;){const m=c[h];if(!m||!1===m.enable)continue;let y;s&&s.length&&(y=[...s]);const g=m.effects;g&&g.length&&(s?y.push(...g):y=[...g]);const p=[];switch(l.c.findApplicableOverrides(m,t,p),m.type){case"CIMSolidFill":w(m,y,n,p,r,i);break;case"CIMPictureFill":M(m,y,n,p,r,o,i);break;case"CIMHatchFill":v(m,y,n,p,r,i);break;case"CIMGradientFill":k(m,y,n,p,r,i);break;case"CIMSolidStroke":S(m,y,n,p,r,i,"CIMPolygonSymbol"===e.type,u);break;case"CIMPictureStroke":C(m,y,n,p,r,i,"CIMPolygonSymbol"===e.type,u);break;case"CIMGradientStroke":I(m,y,n,p,r,i,"CIMPolygonSymbol"===e.type,u);break;case"CIMCharacterMarker":if(P(m,y,n,p,r,i))break;break;case"CIMPictureMarker":if(P(m,y,n,p,r,i))break;"CIMLineSymbol"===e.type&&(f=x(m)),z(m,y,n,p,r,o,i,f,u);break;case"CIMVectorMarker":if(P(m,y,n,p,r,i))break;"CIMLineSymbol"===e.type&&(f=x(m)),N(m,y,n,p,r,i,o,f,u,a);break;default:d.error("Cannot analyze CIM layer",m.type)}}}(a,c,f,t,o,n,i)}return o}function w(e,t,n,r,i,o){const a=e.primitiveName,s=Object(u.e)(e.color),[l,f]=H(r,a),h=Object(c.b)(JSON.stringify(e)+f).toString();o.push({type:"fill",templateHash:h,materialHash:l?()=>h:h,cim:e,materialOverrides:null,colorLocked:e.colorLocked,color:F(a,n,"Color",i,s,_),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:t})}function M(e,t,n,r,i,a,s){const l=e.primitiveName,f=e.tintColor?Object(u.e)(e.tintColor):{r:255,g:255,b:255,a:1},[h,m]=H(r,l),d=Object(c.b)(JSON.stringify(e)+m).toString(),y=Object(c.b)(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString();let g=Object(u.f)(e.scaleX);if("width"in e){const t=e.width;let n=1;const r=a.getResource(e.url);Object(o.k)(r)&&(n=r.width/r.height),g/=n*(e.height/t)}s.push({type:"fill",templateHash:d,materialHash:h?()=>y:y,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,color:F(l,n,"TintColor",i,f,_),height:F(l,n,"Height",i,e.height),scaleX:F(l,n,"ScaleX",i,g),angle:F(l,n,"Rotation",i,Object(u.f)(e.rotation)),offsetX:F(l,n,"OffsetX",i,Object(u.f)(e.offsetX)),offsetY:F(l,n,"OffsetY",i,Object(u.f)(e.offsetY)),url:e.url})}function v(e,t,n,r,i,o){const a=["Rotation","OffsetX","OffsetY"],s=r.filter(t=>t.primitiveName!==e.primitiveName&&-1===a.indexOf(t.propertyName)),l=e.primitiveName,[f,h]=H(r,l),m=Object(c.b)(JSON.stringify(e)+h).toString(),d=Object(c.b)(`${e.separation}${JSON.stringify(e.lineSymbol)}`).toString();o.push({type:"fill",templateHash:m,materialHash:f?Y(d,n,s,i):d,cim:e,materialOverrides:s,colorLocked:e.colorLocked,effects:t,color:{r:255,g:255,b:255,a:1},height:F(l,n,"Separation",i,e.separation),scaleX:1,angle:F(l,n,"Rotation",i,Object(u.f)(e.rotation)),offsetX:F(l,n,"OffsetX",i,Object(u.f)(e.offsetX)),offsetY:F(l,n,"OffsetY",i,Object(u.f)(e.offsetY))})}function k(e,t,n,r,i,o){const a=e.primitiveName,[s,l]=H(r,a),f=Object(c.b)(JSON.stringify(e)+l).toString();o.push({type:"fill",templateHash:f,materialHash:s?Y(f,n,r,i):f,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function S(e,t,n,r,i,o,a,s){const l=e.primitiveName,f=Object(u.e)(e.color),h=void 0!==e.width?e.width:4,m=y(e.capStyle),d=g(e.joinStyle),p=e.miterLimit,[b,O]=H(r,l),x=Object(c.b)(JSON.stringify(e)+O).toString();let j,w;if(t&&t.length>0){const n=t[t.length-1];if("CIMGeometricEffectDashes"===n.type&&"NoConstraint"===n.lineDashEnding){const n=(t=[...e.effects]).pop();j=n.dashTemplate,w=n.scaleDash}}o.push({type:"line",templateHash:x,materialHash:b?()=>x:x,cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:t,color:F(l,n,"Color",i,f,_),width:F(l,n,"Width",i,h),cap:F(l,n,"CapStyle",i,m),join:F(l,n,"JoinStyle",i,d),miterLimit:F(l,n,"MiterLimit",i,p),referenceWidth:s,zOrder:X(e.name),dashTemplate:j,scaleDash:w})}function C(e,t,n,r,i,o,a,s){const l=Object(c.b)(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),f=e.primitiveName,h=Object(u.e)(e.tintColor),m=void 0!==e.width?e.width:4,d=y(e.capStyle),p=g(e.joinStyle),b=e.miterLimit,[O,x]=H(r,f),j=Object(c.b)(JSON.stringify(e)+x).toString();o.push({type:"line",templateHash:j,materialHash:O?()=>l:l,cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:t,color:F(f,n,"TintColor",i,h,_),width:F(f,n,"Width",i,m),cap:F(f,n,"CapStyle",i,d),join:F(f,n,"JoinStyle",i,p),miterLimit:F(f,n,"MiterLimit",i,b),referenceWidth:s,zOrder:X(e.name),dashTemplate:null,scaleDash:!1,url:e.url})}function I(e,t,n,r,i,o,a,s){const l=e.primitiveName,f=void 0!==e.width?e.width:4,u=y(e.capStyle),h=g(e.joinStyle),m=e.miterLimit,[d,p]=H(r,l),b=Object(c.b)(JSON.stringify(e)+p).toString();o.push({type:"line",templateHash:b,materialHash:d?Y(b,n,r,i):b,cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:t,color:{r:128,g:128,b:128,a:1},width:F(l,n,"Width",i,f),cap:F(l,n,"CapStyle",i,u),join:F(l,n,"JoinStyle",i,h),miterLimit:F(l,n,"MiterLimit",i,m),referenceWidth:s,zOrder:X(e.name),dashTemplate:null,scaleDash:!1})}function P(e,t,n,r,i,o){const a=e.markerPlacement;if(!a||"CIMMarkerPlacementInsidePolygon"!==a.type)return!1;const s=a,l=["Rotation","OffsetX","OffsetY"],f=r.filter(t=>t.primitiveName!==e.primitiveName&&-1===l.indexOf(t.propertyName)),h="url"in e?e.url:null,[m,d]=H(r,s.primitiveName),y=Object(c.b)(JSON.stringify(e)+d).toString();let g=s.stepY,p=null,b=1;return a.shiftOddRows&&(g*=2,p=function(e){return e?2*e:0},b=.5),o.push({type:"fill",templateHash:y,materialHash:m?Y(y,n,f,i):y,cim:e,materialOverrides:f,colorLocked:e.colorLocked,effects:t,color:{r:255,g:255,b:255,a:1},height:F(s.primitiveName,n,"StepY",i,g,p),scaleX:b,angle:F(s.primitiveName,n,"GridAngle",i,s.gridAngle),offsetX:F(s.primitiveName,n,"OffsetX",i,Object(u.f)(s.offsetX)),offsetY:F(s.primitiveName,n,"OffsetY",i,Object(u.f)(s.offsetY)),url:h}),!0}function z(e,t,n,r,i,a,s,l,f){var h;const m=e.primitiveName,d=Object(u.f)(e.size);let y=Object(u.f)(e.scaleX);const g=Object(u.f)(e.rotation),p=Object(u.f)(e.offsetX),b=Object(u.f)(e.offsetY),O=e.tintColor?Object(u.e)(e.tintColor):{r:255,g:255,b:255,a:1},x=Object(c.b)(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),[j,w]=H(r,m),M=Object(c.b)(JSON.stringify(e)+w).toString(),v=null!=(h=e.anchorPoint)?h:{x:0,y:0};if("width"in e){const t=e.width;let n=1;const r=a.getResource(e.url);Object(o.k)(r)&&(n=r.width/r.height),y/=n*(d/t)}s.push({type:"marker",templateHash:M,materialHash:j?()=>x:x,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:!1,alignment:l,size:F(m,n,"Size",i,d),scaleX:F(m,n,"ScaleX",i,y),rotation:F(m,n,"Rotation",i,g),offsetX:F(m,n,"OffsetX",i,p),offsetY:F(m,n,"OffsetY",i,b),color:F(m,n,"TintColor",i,O,_),anchorPoint:{x:v.x,y:-v.y},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:e.rotateClockwise,referenceSize:f,sizeRatio:1,markerPlacement:e.markerPlacement,url:e.url})}function N(e,t,n,r,i,o,a,c,s,l){const f=e.markerGraphics;if(!f)return;let u=0;if(e.scaleSymbolsProportionally){const t=e.frame;t&&(u=t.ymax-t.ymin)}for(const h of f)if(h){const f=h.symbol;if(!f)continue;switch(f.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":A(e,t,h,r,n,i,o,a,c,s,u,l);break;case"CIMTextSymbol":L(e,t,h,n,r,i,o,c,s,u)}}}function L(e,t,n,r,i,o,a,s,f,h){l.c.findApplicableOverrides(n,i,[]);const m=n.geometry;if(!("x"in m)||!("y"in m))return;const d=n.symbol,y=function(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}(d),g=function(e){let t="",n="";if(e){const r=e.toLowerCase();-1!==r.indexOf("italic")?t="italic":-1!==r.indexOf("oblique")&&(t="oblique"),-1!==r.indexOf("bold")?n="bold":-1!==r.indexOf("light")&&(n="lighter")}return{style:t,weight:n}}(d.fontStyleName),O=Object(u.m)(d.fontFamilyName);d.font={family:O,decoration:y,...g};const x=e.frame,j=m.x-.5*(x.xmin+x.xmax),w=m.y-.5*(x.ymin+x.ymax),M=e.size/h,v=e.primitiveName,k=Object(u.f)(d.height)*M,S=Object(u.f)(d.angle),C=(Object(u.f)(d.offsetX)+j)*M,I=(Object(u.f)(d.offsetY)+w)*M,P=Object(u.e)(l.b.getFillColor(d));let z=Object(u.e)(l.b.getStrokeColor(d)),N=l.b.getStrokeWidth(d);N||(z=Object(u.e)(l.b.getFillColor(d.haloSymbol)),N=d.haloSize*M);const[L,A]=H(i,v),R=JSON.stringify(e.effects)+Number(e.colorLocked)+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement),X=Object(c.b)(JSON.stringify(n)+R+A).toString(),_=F(n.primitiveName,r,"TextString",o,n.textString,u.a,d.textCase),{fontStyleName:Y}=d,D=O+(Y?"-"+Y.toLowerCase():"-regular"),J=D;a.push({type:"text",templateHash:X,materialHash:L||"function"==typeof _||_.match(/\[(.*?)\]/)?(e,t,n)=>J+"-"+Object(u.d)(_,e,t,n):J+"-"+Object(c.b)(_),cim:d,materialOverrides:null,colorLocked:e.colorLocked,effects:t,alignment:s,anchorPoint:{x:e.anchorPoint?e.anchorPoint.x:0,y:e.anchorPoint?e.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,fontName:D,decoration:y,weight:F(v,r,"Weight",o,g.weight),style:F(v,r,"Size",o,g.style),size:F(v,r,"Size",o,k),angle:F(v,r,"Rotation",o,S),offsetX:F(v,r,"OffsetX",o,C),offsetY:F(v,r,"OffsetY",o,I),horizontalAlignment:p(d.horizontalAlignment),verticalAlignment:b(d.verticalAlignment),text:_,color:P,outlineColor:z,outlineSize:N,referenceSize:f,sizeRatio:1,markerPlacement:e.markerPlacement})}function A(e,t,n,r,i,o,a,s,m,d,y,g){const p=n.symbol,b=p.symbolLayers;if(!b)return;if(g)return void R(e,t,n,i,r,o,a,s,m,d,y);let O=b.length;if(J(b))return void function(e,t,n,r,i,o,a,s,h,m){const d=t.geometry,y=n[0],g=n[1],p=Object(f.b)(d);if(!p)return;const[b,O,x]=Object(f.d)(p,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),j={type:"sdf",geom:d,asFill:!0},w=e.primitiveName,M=Object(u.f)(e.size),v=Object(u.f)(e.rotation),k=Object(u.f)(e.offsetX),S=Object(u.f)(e.offsetY),C=g.path,I=g.primitiveName,P=y.primitiveName,z=Object(u.e)(l.b.getFillColor(g)),N=Object(u.e)(l.b.getStrokeColor(y)),L=l.b.getStrokeWidth(y);let A=!1,R="";for(const e of r)e.primitiveName!==I&&e.primitiveName!==P&&e.primitiveName!==w||(void 0!==e.value?R+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`:e.valueExpressionInfo&&(A=!0));const X=JSON.stringify({...e,markerGraphics:null}),Y=Object(c.b)(JSON.stringify(j)+C).toString(),D={type:"marker",templateHash:Object(c.b)(JSON.stringify(t)+JSON.stringify(g)+JSON.stringify(y)+X+R).toString(),materialHash:A?()=>Y:Y,cim:j,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:s,anchorPoint:{x:O,y:x},isAbsoluteAnchorPoint:!1,size:F(e.primitiveName,i,"Size",o,M),rotation:F(e.primitiveName,i,"Rotation",o,v),offsetX:F(e.primitiveName,i,"OffsetX",o,k),offsetY:F(e.primitiveName,i,"OffsetY",o,S),scaleX:1,frameHeight:m,rotateClockwise:e.rotateClockwise,referenceSize:h,sizeRatio:b,color:F(I,i,"Color",o,z,_),outlineColor:F(P,i,"Color",o,N,_),outlineWidth:F(P,i,"Width",o,L),markerPlacement:e.markerPlacement,path:C};a.push(D)}(e,n,b,r,i,o,a,m,d,y);const x=h.a.applyEffects(p.effects,n.geometry);if(x)for(;O--;){const g=b[O];if(g&&!1!==g.enable)switch(g.type){case"CIMSolidFill":case"CIMSolidStroke":{var j;const s=h.a.applyEffects(g.effects,x),p=Object(f.b)(s);if(!p)continue;const[b,O,w]=Object(f.d)(p,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),M="CIMSolidFill"===g.type,v={type:"sdf",geom:s,asFill:M},k=e.primitiveName,S=null!=(j=Object(u.f)(e.size))?j:10,C=Object(u.f)(e.rotation),I=Object(u.f)(e.offsetX),P=Object(u.f)(e.offsetY),z=g.path,N=g.primitiveName,L=Object(u.e)(M?l.b.getFillColor(g):l.b.getStrokeColor(g)),A=M?{r:0,g:0,b:0,a:0}:Object(u.e)(l.b.getStrokeColor(g)),R=l.b.getStrokeWidth(g);if(!M&&!R)break;let X=!1,Y="";for(const e of r)e.primitiveName!==N&&e.primitiveName!==k||(void 0!==e.value?Y+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`:e.valueExpressionInfo&&(X=!0));const D=JSON.stringify({...e,markerGraphics:null}),H=Object(c.b)(JSON.stringify(v)+z).toString(),J={type:"marker",templateHash:Object(c.b)(JSON.stringify(n)+JSON.stringify(g)+D+Y).toString(),materialHash:X?()=>H:H,cim:v,materialOverrides:null,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:m,anchorPoint:{x:O,y:w},isAbsoluteAnchorPoint:!1,size:F(e.primitiveName,i,"Size",o,S),rotation:F(e.primitiveName,i,"Rotation",o,C),offsetX:F(e.primitiveName,i,"OffsetX",o,I),offsetY:F(e.primitiveName,i,"OffsetY",o,P),scaleX:1,frameHeight:y,rotateClockwise:e.rotateClockwise,referenceSize:d,sizeRatio:b,color:F(N,i,"Color",o,L,_),outlineColor:F(N,i,"Color",o,A,_),outlineWidth:F(N,i,"Width",o,R),markerPlacement:e.markerPlacement,path:z};a.push(J);break}default:R(e,t,n,i,r,o,a,s,m,d,y)}}}function R(e,t,n,r,i,o,s,f,h,m,d){const y=function(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath}}(e,n);let g=[];const p=["Rotation","OffsetX","OffsetY"];g=i.filter(t=>t.primitiveName!==e.primitiveName||-1===p.indexOf(t.propertyName));let b="";for(const e of i)void 0!==e.value&&(b+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`);const[O,x,j]=l.b.getTextureAnchor(y,f),w=e.primitiveName,M=Object(u.f)(e.rotation),v=Object(u.f)(e.offsetX),k=Object(u.f)(e.offsetY),S=Object(c.b)(JSON.stringify(y)+b).toString(),C={type:"marker",templateHash:S,materialHash:0===g.length?S:Y(S,r,g,o),cim:y,materialOverrides:g,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:h,anchorPoint:{x:O,y:x},isAbsoluteAnchorPoint:!1,size:e.size,rotation:F(w,r,"Rotation",o,M),offsetX:F(w,r,"OffsetX",o,v),offsetY:F(w,r,"OffsetY",o,k),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:d,rotateClockwise:e.rotateClockwise,referenceSize:m,sizeRatio:j/Object(a.c)(e.size),markerPlacement:e.markerPlacement};s.push(C)}function X(e){if(e&&0===e.indexOf("Level_")){const t=parseInt(e.substr(6),10);if(NaN!==t)return t}return 0}function _(e){if(!e||0===e.length)return null;const t=new r.a(e).toRgba();return{r:t[0],g:t[1],b:t[2],a:t[3]}}function F(e,t,n,r,i,o,a){const c=t[e];if(c){const e=c[n];if("string"==typeof e||"number"==typeof e||e instanceof Array)return o?o.call(null,e,a):e;if(null!=e&&e instanceof s.a)return(t,n,c)=>{let s=Object(m.a)(e,t,{$view:c},r.geometryType,n);return null!==s&&o&&(s=o.call(null,s,a)),null!==s?s:i}}return i}function Y(e,t,n,r){for(const e of n)if(e.valueExpressionInfo){const n=t[e.primitiveName]&&t[e.primitiveName][e.propertyName];n instanceof s.a&&(e.fn=(e,t,i)=>Object(m.a)(n,e,{$view:i},r.geometryType,t))}return(t,r,i)=>{for(const e of n)e.fn&&(e.value=e.fn(t,r,i));return Object(c.b)(e+l.c.buildOverrideKey(n)).toString()}}function D(e,t){if(!t||0===t.length)return e;const n=JSON.parse(JSON.stringify(e));return l.c.applyOverrides(n,t),n}function H(e,t){let n=!1,r="";for(const i of e)i.primitiveName===t&&(void 0!==i.value?r+=`-${i.primitiveName}-${i.propertyName}-${JSON.stringify(i.value)}`:i.valueExpressionInfo&&(n=!0));return[n,r]}const J=e=>e&&2===e.length&&e[0].enable&&e[1].enable&&"CIMSolidStroke"===e[0].type&&"CIMSolidFill"===e[1].type&&!e[0].effects&&!e[1].effects},430:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(344),i=n(343),o=n(420);function a(e,t,n,r,o){const a=e.referencesGeometry()&&o?s(t,r,o):t,c=e.repurposeFeature(a);try{return e.evaluate({...n,$feature:c})}catch(e){return i.a.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}const c=new Map;function s(e,t,n){const{transform:a,hasZ:s,hasM:l}=n;c.has(t)||c.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,n,r,i)=>Object(o.e)(n,t,e,r,i);case"esriGeometryPolygon":return(e,n,r,i)=>Object(o.f)(n,t,e,r,i);case"esriGeometryPolyline":return(e,n,r,i)=>Object(o.g)(n,t,e,r,i);case"esriGeometryMultipoint":return(e,n,r,i)=>Object(o.d)(n,t,e,r,i);default:return i.a.getLogger("esri.views.2d.support.arcadeOnDemand").error(new r.a("mapview-arcade","Unable to handle geometryType: "+e)),e=>e}}(t));const f=c.get(t)(e.geometry,a,s,l);return{...e,geometry:f}}},478:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return l}));var r=n(557),i=n(351),o=n(477);function a(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":{const t=e.symbolLayers;return t&&1===t.length?a(t[0]):null}case"CIMVectorMarker":{var t;const n=e.markerGraphics;if(!n||1!==n.length)return null;const r=n[0];if(!r)return null;const i=r.geometry;if(!i)return null;const o=r.symbol;return!o||"CIMPolygonSymbol"!==o.type&&"CIMLineSymbol"!==o.type||null!=(t=o.symbolLayers)&&t.some(e=>!!e.effects)?null:{geom:i,asFill:"CIMPolygonSymbol"===o.type}}case"sdf":return{geom:e.geom,asFill:e.asFill}}return null}function c(e){let t=1/0,n=-1/0,r=1/0,i=-1/0;for(const o of e)for(const e of o)e[0]<t&&(t=e[0]),e[0]>n&&(n=e[0]),e[1]<r&&(r=e[1]),e[1]>i&&(i=e[1]);return[t,r,n,i]}function s(e){return e?e.rings?c(e.rings):e.paths?c(e.paths):Object(i.d)(e)?[e.xmin,e.ymin,e.xmax,e.ymax]:null:null}function l(e,t,n,r,i){const[o,a,c,s]=e;if(c<o||s<a)return[0,0,0];const l=c-o,f=s-a,u=Math.floor(31.5),h=(128-2*(u+1))/Math.max(l,f),m=Math.round(l*h)+2*u,d=Math.round(f*h)+2*u;let y=1;t&&(y=d/h/(t.ymax-t.ymin));let g=0,p=0;if(r)if(i){if(t&&n&&t.ymax-t.ymin>0){const e=(t.xmax-t.xmin)/(t.ymax-t.ymin);g=r.x/(n*e),p=r.y/n}}else g=r.x,p=r.y;return g=.5*(t.xmax+t.xmin)+g*(t.xmax-t.xmin),p=.5*(t.ymax+t.ymin)+p*(t.ymax-t.ymin),g-=o,p-=a,g*=h,p*=h,g+=u,p+=u,[y,g/m-.5,-(p/d-.5)]}function f(e){const t=function(e){return e?e.rings?e.rings:e.paths?e.paths:void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:null:null}(e.geom),n=function(e){let t=1/0,n=-1/0,r=1/0,i=-1/0;for(const o of e)for(const e of o)e[0]<t&&(t=e[0]),e[0]>n&&(n=e[0]),e[1]<r&&(r=e[1]),e[1]>i&&(i=e[1]);return new o.a(t,r,n-t,i-r)}(t),r=Math.floor(31.5),i=(128-2*(r+1))/Math.max(n.width,n.height),a=Math.round(n.width*i)+2*r,c=Math.round(n.height*i)+2*r,s=[];for(const o of t)if(o&&o.length>1){const t=[];for(const a of o){let[o,c]=a;o-=n.x,c-=n.y,o*=i,c*=i,o+=r-.5,c+=r-.5,e.asFill?t.push([o,c]):t.push([Math.round(o),Math.round(c)])}if(e.asFill){const e=t.length-1;t[0][0]===t[e][0]&&t[0][1]===t[e][1]||t.push(t[0])}s.push(t)}const l=function(e,t,n,r){const i=t*n,o=new Array(i),a=r*r+1;for(let e=0;e<i;++e)o[e]=a;for(const i of e){const e=i.length;for(let a=1;a<e;++a){const e=i[a-1],c=i[a];let s,l,f,u;e[0]<c[0]?(s=e[0],l=c[0]):(s=c[0],l=e[0]),e[1]<c[1]?(f=e[1],u=c[1]):(f=c[1],u=e[1]);let h=Math.floor(s)-r,m=Math.floor(l)+r,d=Math.floor(f)-r,y=Math.floor(u)+r;h<0&&(h=0),m>t&&(m=t),d<0&&(d=0),y>n&&(y=n);const g=c[0]-e[0],p=c[1]-e[1],b=g*g+p*p;for(let r=h;r<m;r++)for(let i=d;i<y;i++){let a,s,l=(r-e[0])*g+(i-e[1])*p;l<0?(a=e[0],s=e[1]):l>b?(a=c[0],s=c[1]):(l/=b,a=e[0]+l*g,s=e[1]+l*p);const f=(r-a)*(r-a)+(i-s)*(i-s),u=(n-i-1)*t+r;f<o[u]&&(o[u]=f)}}}for(let e=0;e<i;++e)o[e]=Math.sqrt(o[e]);return o}(s,a,c,r);return e.asFill&&function(e,t,n,r,i){for(const o of e){const e=o.length;for(let a=1;a<e;++a){const e=o[a-1],c=o[a];let s,l,f,u;e[0]<c[0]?(s=e[0],l=c[0]):(s=c[0],l=e[0]),e[1]<c[1]?(f=e[1],u=c[1]):(f=c[1],u=e[1]);let h=Math.floor(s),m=Math.floor(l)+1,d=Math.floor(f),y=Math.floor(u)+1;h<r&&(h=r),m>t-r&&(m=t-r),d<r&&(d=r),y>n-r&&(y=n-r);for(let o=d;o<y;++o){if(e[1]>o==c[1]>o)continue;const a=(n-o-1)*t;for(let t=h;t<m;++t)t<(c[0]-e[0])*(o-e[1])/(c[1]-e[1])+e[0]&&(i[a+t]=-i[a+t]);for(let e=r;e<h;++e)i[a+e]=-i[a+e]}}}}(s,a,c,r,l),[u(l,r),a,c]}function u(e,t){const n=2*t,i=e.length,o=new Uint8Array(4*i);for(let t=0;t<i;++t){const i=.5-e[t]/n;Object(r.a)(i,o,4*t)}return o}},565:function(e,t,n){"use strict";function r(e){return"h"in e&&"s"in e&&"v"in e}function i(e){return"l"in e&&"a"in e&&"b"in e}function o(e){return"l"in e&&"c"in e&&"h"in e}function a(e){return"x"in e&&"y"in e&&"z"in e}n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return x})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return b}));const c=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],s=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function l(e,t){const n=[];let r,i;if(e[0].length!==t.length)throw"dimensions do not match";const o=e.length,a=e[0].length;let c=0;for(r=0;r<o;r++){for(c=0,i=0;i<a;i++)c+=e[r][i]*t[i];n.push(c)}return n}function f(e){const t=[e.r/255,e.g/255,e.b/255].map(e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4),n=l(c,t);return{x:100*n[0],y:100*n[1],z:100*n[2]}}function u(e){const t=l(s,[e.x/100,e.y/100,e.z/100]).map(e=>{const t=e<=.0031308?12.92*e:1.055*e**(1/2.4)-.055;return Math.min(1,Math.max(t,0))});return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function h(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map(e=>e>(6/29)**3?e**(1/3):1/3*(29/6)**2*e+4/29);return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function m(e){const t=e.l,n=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map(e=>e>6/29?e**3:3*(6/29)**2*(e-4/29));return{x:95.047*n[0],y:100*n[1],z:108.883*n[2]}}function d(e){return h(f(e))}function y(e){return u(m(e))}function g(e){return function(e){const t=e.l,n=e.a,r=e.b,i=Math.sqrt(n*n+r*r);let o=Math.atan2(r,n);return o=o>0?o:o+2*Math.PI,{l:t,c:i,h:o}}(h(f(e)))}function p(e){return u(m(function(e){const t=e.l,n=e.c,r=e.h;return{l:t,a:n*Math.cos(r),b:n*Math.sin(r)}}(e)))}function b(e){return function(e){return"r"in e&&"g"in e&&"b"in e}(e)?e:o(e)?p(e):i(e)?y(e):a(e)?u(e):r(e)?function(e){const t=(e.h+360)%360/60,n=e.s/100,r=e.v/100*255,i=r*n,o=i*(1-Math.abs(t%2-1));let a;switch(Math.floor(t)){case 0:a={r:i,g:o,b:0};break;case 1:a={r:o,g:i,b:0};break;case 2:a={r:0,g:i,b:o};break;case 3:a={r:0,g:o,b:i};break;case 4:a={r:o,g:0,b:i};break;case 5:case 6:a={r:i,g:0,b:o};break;default:a={r:0,g:0,b:0}}return a.r=Math.round(a.r+r-i),a.g=Math.round(a.g+r-i),a.b=Math.round(a.b+r-i),a}(e):e}function O(e){return r(e)?e:function(e){const t=e.r,n=e.g,r=e.b,i=Math.max(t,n,r),o=i-Math.min(t,n,r);let a=i,c=0===o?0:i===t?(n-r)/o%6:i===n?(r-t)/o+2:(t-n)/o+4,s=0===o?0:o/a;return c<0&&(c+=6),c*=60,s*=100,a*=100/255,{h:c,s:s,v:a}}(b(e))}function x(e){return i(e)?e:d(b(e))}function j(e){return o(e)?e:g(b(e))}},783:function(e,t,n){"use strict";n.d(t,"a",(function(){return G})),n.d(t,"b",(function(){return $}));var r=n(467),i=n(353),o=n(565),a=n(344),c=n(336),s=(n(735),n(736)),l=n(370),f=n(417),u=n(455),h=(n(409),n(343),n(469));let m=0,d=0;const y=Object(c.a)("android"),g=Object(c.a)("chrome")||y&&y>=4?"auto":"optimizeLegibility",p={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},b=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let O={},x={};const j={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},w=Math.PI;let M=1;function v(e,t){const n=e*(w/180);return Math.abs(t*Math.sin(n))+Math.abs(t*Math.cos(n))}function k(e){return e.map(e=>`${e.command} ${e.values.join(" ")}`).join(" ").trim()}function S(e,t,n,r){if(e){if("circle"===e.type)return Object(h.a)("circle",{fill:t,"fill-rule":"evenodd",stroke:n.color,"stroke-width":n.width,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-dasharray":n.dashArray,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,r:e.r});if("ellipse"===e.type)return Object(h.a)("ellipse",{fill:t,"fill-rule":"evenodd",stroke:n.color,"stroke-width":n.width,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-dasharray":n.dashArray,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,rx:e.rx,ry:e.ry});if("rect"===e.type)return Object(h.a)("rect",{fill:t,"fill-rule":"evenodd",stroke:n.color,"stroke-width":n.width,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-dasharray":n.dashArray,"stroke-miterlimit":"4",x:e.x,y:e.y,width:e.width,height:e.height});if("image"===e.type)return Object(h.a)("image",{href:e.src,x:e.x,y:e.y,width:e.width,height:e.height,preserveAspectRatio:"none"});if("path"===e.type){const r="string"!=typeof e.path?k(e.path):e.path;return Object(h.a)("path",{fill:t,"fill-rule":"evenodd",stroke:n.color,"stroke-width":n.width,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-dasharray":n.dashArray,"stroke-miterlimit":"4",d:r})}if("text"===e.type)return Object(h.a)("text",{fill:t,"fill-rule":"evenodd",stroke:n.color,"stroke-width":n.width,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-dasharray":n.dashArray,"stroke-miterlimit":"4","text-anchor":r.align,"text-decoration":r.decoration,kerning:r.kerning,rotate:r.rotate,"text-rendering":g,"font-style":r.font.style,"font-variant":r.font.variant,"font-weight":r.font.weight,"font-size":r.font.size,"font-family":r.font.family,x:e.x,y:e.y},e.text)}return null}function C(e){const t={fill:"none",pattern:null,linearGradient:null};if(e)if("type"in e&&"pattern"===e.type){const n="patternId-"+ ++m;t.fill=`url(#${n})`,t.pattern={id:n,x:e.x,y:e.y,width:e.width,height:e.height,image:{x:0,y:0,width:e.width,height:e.height,href:e.src}}}else if("type"in e&&"linear"===e.type){const n="linearGradientId-"+ ++d;t.fill=`url(#${n})`,t.linearGradient={id:n,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stops:e.colors.map(e=>({offset:e.offset,color:e.color&&new l.a(e.color).toString()}))}}else if(e){const n=new l.a(e);t.fill=n.toString()}return t}function I(e){const t={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(e&&(null!=e.width&&(t.width=e.width),e.cap&&(t.cap=e.cap),e.join&&(t.join=e.join.toString()),e.color&&(t.color=new l.a(e.color).toString()),e.style)){let n=null;if(e.style in j&&(n=j[e.style]),Array.isArray(n)){n=n.slice(0);for(let t=0;t<n.length;++t)n[t]*=e.width;if("butt"!==e.cap){for(let t=0;t<n.length;t+=2)n[t]-=e.width,n[t]<1&&(n[t]=1);for(let t=1;t<n.length;t+=2)n[t]+=e.width}n=n.join(",")}t.dashArray=n}return t}function P(e,t){const n={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};return e&&(n.align=e.align,n.decoration=e.decoration,n.kerning=e.kerning?"auto":"0",n.rotate=e.rotated?"90":"0",n.font.style=t.style||"normal",n.font.variant=t.variant||"normal",n.font.weight=t.weight||"normal",n.font.size=t.size&&t.size.toString()||"10pt",n.font.family=t.family||"serif"),n}function z(e){const{pattern:t,linearGradient:n}=e;if(t)return Object(h.a)("pattern",{id:t.id,patternUnits:"userSpaceOnUse",x:t.x,y:t.y,width:t.width,height:t.height},Object(h.a)("image",{x:t.image.x,y:t.image.y,width:t.image.width,height:t.image.height,href:t.image.href}));if(n){const e=n.stops.map((e,t)=>Object(h.a)("stop",{key:t+"-stop",offset:e.offset,"stop-color":e.color}));return Object(h.a)("linearGradient",{id:n.id,gradientUnits:"userSpaceOnUse",x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2},e)}return null}function N(e,t,n){return Object(u.h)(e,Object(u.d)(e),[t,n])}function L(e,t,n,r,i){return Object(u.g)(e,Object(u.d)(e),[t,n]),e[4]=e[4]*t-r*t+r,e[5]=e[5]*n-i*n+i,e}function A(e,t){O&&"left"in O?(O.left>e&&(O.left=e),O.right<e&&(O.right=e),O.top>t&&(O.top=t),O.bottom<t&&(O.bottom=t)):O={left:e,bottom:t,right:e,top:t}}function R(e){const t=e.args,n=t.length;let r;switch(e.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(r=0;r<n;r+=2)A(t[r],t[r+1]);x.x=t[n-2],x.y=t[n-1];break;case"H":for(r=0;r<n;++r)A(t[r],x.y);x.x=t[n-1];break;case"V":for(r=0;r<n;++r)A(x.x,t[r]);x.y=t[n-1];break;case"m":{let e=0;"x"in x||(A(x.x=t[0],x.y=t[1]),e=2);for(r=e;r<n;r+=2)A(x.x+=t[r],x.y+=t[r+1]);break}case"l":case"t":for(r=0;r<n;r+=2)A(x.x+=t[r],x.y+=t[r+1]);break;case"h":for(r=0;r<n;++r)A(x.x+=t[r],x.y);break;case"v":for(r=0;r<n;++r)A(x.x,x.y+=t[r]);break;case"c":for(r=0;r<n;r+=6)A(x.x+t[r],x.y+t[r+1]),A(x.x+t[r+2],x.y+t[r+3]),A(x.x+=t[r+4],x.y+=t[r+5]);break;case"s":case"q":for(r=0;r<n;r+=4)A(x.x+t[r],x.y+t[r+1]),A(x.x+=t[r+2],x.y+=t[r+3]);break;case"A":for(r=0;r<n;r+=7)A(t[r+5],t[r+6]);x.x=t[n-2],x.y=t[n-1];break;case"a":for(r=0;r<n;r+=7)A(x.x+=t[r+5],x.y+=t[r+6])}}function X(e,t,n){const r=p[e.toLowerCase()];let i;"number"==typeof r&&(r?t.length>=r&&(i={action:e,args:t.slice(0,t.length-t.length%r)},n.push(i),R(i)):(i={action:e,args:[]},n.push(i),R(i)))}function _(e){const t={x:0,y:0,width:0,height:0};if("circle"===e.type)t.x=e.cx-e.r,t.y=e.cy-e.r,t.width=2*e.r,t.height=2*e.r;else if("ellipse"===e.type)t.x=e.cx-e.rx,t.y=e.cy-e.ry,t.width=2*e.rx,t.height=2*e.ry;else if("image"===e.type||"rect"===e.type)t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height;else if("path"===e.type){const n=function(e){const t=("string"!=typeof e.path?k(e.path):e.path).match(b),n=[];if(O={},x={},!t)return null;let r="",i=[];const o=t.length;for(let e=0;e<o;++e){const o=t[e],a=parseFloat(o);isNaN(a)?(r&&X(r,i,n),i=[],r=o):i.push(a)}X(r,i,n);const a={x:0,y:0,width:0,height:0};return O&&"left"in O&&(a.x=O.left,a.y=O.top,a.width=O.right-O.left,a.height=O.bottom-O.top),a}(e);t.x=n.x,t.y=n.y,t.width=n.width,t.height=n.height}return t}function F(e){const t={x:0,y:0,width:0,height:0};let n=null,r=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;for(const o of e)n?(n.x=Math.min(n.x,o.x),n.y=Math.min(n.y,o.y),r=Math.max(r,o.x+o.width),i=Math.max(i,o.y+o.height)):(n=t,n.x=o.x,n.y=o.y,r=o.x+o.width,i=o.y+o.height);return n&&(n.width=r-n.x,n.height=i-n.y),n}function Y(e,t,n,r,i,o,a,c,s){let l=(a&&o?v(o,t):t)/2,h=(a&&o?v(o,n):n)/2;if(s){const e=s[0],t=s[1];l=(a&&o?v(o,e):e)/2,h=(a&&o?v(o,t):t)/2}const m=e.width+r,d=e.height+r,y=Object(f.a)(),g=Object(f.a)();let p=!1;if(i&&0!==m&&0!==d){const e=m/d,r=t>n?t:n;let i=1,o=1;isNaN(r)||(e>1?(i=r/m,o=r/e/d):(o=r/d,i=r*e/m)),Object(u.e)(g,g,L(y,i,o,l,h)),p=!0}const b=e.x+(m-r)/2,O=e.y+(d-r)/2;if(Object(u.e)(g,g,N(y,l-b,h-O)),!p&&(m>t||d>n)){const e=m/t>d/n,r=(e?t:n)/(e?m:d);Object(u.e)(g,g,L(y,r,r,b,O))}return o&&Object(u.e)(g,g,function(e,t,n,r){const i=t%360*Math.PI/180;Object(u.f)(e,Object(u.d)(e),i);const o=Math.cos(i),a=Math.sin(i),c=e[4],s=e[5];return e[4]=c*o-s*a+r*a-n*o+n,e[5]=s*o+c*a-n*a-r*o+r,e}(y,o,b,O)),c&&Object(u.e)(g,g,N(y,c[0],c[1])),`matrix(${g[0]},${g[1]},${g[2]},${g[3]},${g[4]},${g[5]})`}function D(e,t,n,r){const i=[],o=[],a=++M,c=function(e,t,n){const r=null==e?void 0:e.effects.find(e=>"bloom"===e.type);if(!r)return null;const{strength:i,radius:o}=r,a=i>0?o:0,c=(i+a)*t,s=4*i+1;return Object(h.a)("filter",{id:"bloom"+n,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},Object(h.a)("feMorphology",{operator:"dilate",radius:(i+.5*a)*(5**(t/100)*(.4+t/100)),in:"SourceGraphic",result:"dilate"}),Object(h.a)("feGaussianBlur",{in:"dilate",stdDeviation:c/25,result:"blur"}),Object(h.a)("feGaussianBlur",{in:"blur",stdDeviation:c/50,result:"intensityBlur"}),Object(h.a)("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},Object(h.a)("feFuncR",{type:"linear",slope:s}),Object(h.a)("feFuncG",{type:"linear",slope:s}),Object(h.a)("feFuncB",{type:"linear",slope:s})),Object(h.a)("feMerge",null,Object(h.a)("feMergeNode",{in:"intensityBlur"}),Object(h.a)("feMergeNode",{in:"intensityBrightness"}),Object(h.a)("feGaussianBlur",{stdDeviation:i/10})))}(null==r?void 0:r.effectView,t,a);let s=null;if(c){var l;const e=null==r||null==(l=r.effectView)?void 0:l.effects.find(e=>"bloom"===e.type),i=(e.strength?e.strength+e.radius/2:0)/3,o=t+t*i,a=n+n*i;s=[Math.max(o,10),Math.max(a,10)]}for(const a of e){const e=[],c=[];let l=0,f=0,u=0;for(const t of a){const{shape:n,fill:r,stroke:o,font:a,offset:s}=t;l+=o&&o.width||0;const h=C(r),m=I(o),d="text"===n.type?P(n,a):null;i.push(z(h)),e.push(S(n,h.fill,m,d)),c.push(_(n)),s&&(f+=s[0],u+=s[1])}const m=Y(F(c),t,n,l,null==r?void 0:r.scale,null==r?void 0:r.rotation,null==r?void 0:r.useRotationSize,[f,u],s);o.push(Object(h.a)("g",{transform:m},e))}return null!=r&&r.useRotationSize&&null!=r&&r.rotation&&(t=v(null==r?void 0:r.rotation,t),n=v(null==r?void 0:r.rotation,n)),c&&(t=s[0],n=s[1]),Object(h.a)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:n},c,Object(h.a)("defs",null,i),c?Object(h.a)("g",{filter:`url(#bloom${a})`},o):o)}var H=n(699);const J=Object(s.a)();function G(e,t,n){const r=Math.ceil(t[0]),i=Math.ceil(t[1]);if(!e.some(e=>!!e.length))return null;const o=n&&n.node||document.createElement("div");return null!=n.opacity&&(o.style.opacity=n.opacity.toString()),null!=n.effectView&&(o.style.filter=Object(H.e)(n.effectView)),J.append(o,D.bind(null,e,r,i,n)),o}function T(e,t,n,r,i){switch(i){case"multiply":e[t+0]*=n[0],e[t+1]*=n[1],e[t+2]*=n[2],e[t+3]*=n[3];break;default:{const i=Object(o.a)({r:e[t+0],g:e[t+1],b:e[t+2]});i.h=r.h,i.s=r.s,i.v=i.v/100*r.v;const a=Object(o.d)(i);e[t+0]=a.r,e[t+1]=a.g,e[t+2]=a.b,e[t+3]*=n[3];break}}}function $(e,t,n,s,l){return function(e,t,n){return e?Object(i.default)(e,{responseType:"image"}).then(e=>{const r=e.data,i=r.width,o=r.height,a=i/o;let c=t;if(n){const e=Math.max(i,o);c=Math.min(c,e)}return{image:r,width:a<=1?Math.ceil(c*a):c,height:a<=1?c:Math.ceil(c/a)}}):Promise.reject(new a.a("renderUtils: imageDataSize","href not provided."))}(e,t,l).then(i=>{const a=i.width?i.width:t,l=i.height?i.height:t;if(i.image&&function(e,t){return!(!e||"ignore"===t||"multiply"===t&&255===e.r&&255===e.g&&255===e.b&&1===e.a)}(n,s)){let t=i.image.width,r=i.image.height;Object(c.a)("edge")&&/\.svg$/i.test(e)&&(t-=1,r-=1);const f=function(e,t){e=Math.ceil(e),t=Math.ceil(t);const n=document.createElement("canvas");n.width=e,n.height=t,n.style.width=e+"px",n.style.height=t+"px";const r=n.getContext("2d");return r.clearRect(0,0,e,t),r}(a,l);f.drawImage(i.image,0,0,t,r,0,0,a,l);const u=f.getImageData(0,0,a,l),h=[n.r/255,n.g/255,n.b/255,n.a],m=Object(o.a)(n);for(let e=0;e<u.data.length;e+=4)T(u.data,e,h,m,s);f.putImageData(u,0,0),e=f.canvas.toDataURL("image/png")}else{const t=r.b&&r.b.findCredential(e);if(t&&t.token){const n=-1===e.indexOf("?")?"?":"&";e=`${e}${n}token=${t.token}`}}return{url:e,width:a,height:l}}).catch((function(){return{url:e,width:t,height:t}}))}},949:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(404),i=n(477),o=n(478),a=n(416);class c{constructor(e){this._resourceManager=e}dispose(){this._rasterizationCanvas=null}rasterizeJSONResource(e,t,n){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===e.type||"esriSFS"===e.type){const[n,i,o]=r.d.rasterizeSimpleFill(this._rasterizationCanvas,e.style,t);return{size:[i,o],image:new Uint32Array(n.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===e.type||"esriSLS"===e.type||"line"===e.type&&e.dashTemplate){let t,n;if("simple-line"===e.type||"esriSLS"===e.type)switch(t=Object(r.e)(e.style,e.cap),e.cap){case"butt":n="Butt";break;case"square":n="Square";break;default:n="Round"}else t=e.dashTemplate,n=e.cim.capStyle;const[i,o,a]=r.d.rasterizeSimpleLine(t,n);return{size:[o,a],image:new Uint32Array(i.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let a,c,s;if("simple-marker"===e.type||"esriSMS"===e.type||"line-marker"===e.type?(a=r.b.fromSimpleMarker(e),s=Object(o.c)(a)):e.cim&&"CIMHatchFill"===e.cim.type?(a=r.b.fromCIMHatchFill(e.cim),c=new i.a(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin)):e.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===e.cim.markerPlacement.type?(a=r.b.fromCIMInsidePolygon(e.cim),c=new i.a(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin)):(a=e.cim,s=Object(o.c)(a)),s&&!n){const[e,t,n]=Object(o.a)(s);return e?{size:[t,n],image:new Uint32Array(e.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const[l,f,u,h,m]=r.b.rasterize(this._rasterizationCanvas,a,c,this._resourceManager,!n);return l?{size:[f,u],image:new Uint32Array(l.buffer),sdf:!1,simplePattern:!1,anchorX:h,anchorY:m}:null}rasterizeImageResource(e,t,n,r){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),this._rasterizationCanvas.width=e,this._rasterizationCanvas.height=t;const i=this._rasterizationCanvas.getContext("2d");n instanceof ImageData?i.putImageData(n,0,0):(n.setAttribute("width",e+"px"),n.setAttribute("height",t+"px"),i.drawImage(n,0,0,e,t));const o=i.getImageData(0,0,e,t),c=new Uint8Array(o.data);if(r)for(const e of r)if(e&&e.oldColor&&4===e.oldColor.length&&e.newColor&&4===e.newColor.length){const[t,n,r,i]=e.oldColor,[o,a,s,l]=e.newColor;if(t===o&&n===a&&r===s&&i===l)continue;for(let e=0;e<c.length;e+=4)t===c[e]&&n===c[e+1]&&r===c[e+2]&&i===c[e+3]&&(c[e]=o,c[e+1]=a,c[e+2]=s,c[e+3]=l)}let s;for(let e=0;e<c.length;e+=4)s=c[e+3]/255,c[e]=c[e]*s,c[e+1]=c[e+1]*s,c[e+2]=c[e+2]*s;let l=c,f=e,u=t;const h=512;if(f>=h||u>=h){const n=f/u;n>1?(f=h,u=Math.round(h/n)):(u=h,f=Math.round(h*n)),l=new Uint8Array(4*f*u);const r=new Uint8ClampedArray(l.buffer);Object(a.k)(c,e,t,r,f,u,!1)}return{size:[f,u],image:new Uint32Array(l.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}}}]);